<!DOCTYPE html><html><head>
    <style>
        html {
            font-size: 62.5%;
        }
        body {
            font-size: 1.5em;
            line-height: 1.6;
            font-weight: 400;
            font-family: "SF Pro Text", "SF Pro Icons", "Helvetica Neue", "Helvetica", "Arial", sans-serif;
            margin: 0;
            padding: 0;
            color: #777;
            background: #ecf0f3;
        }
        #section_container {
            position: relative;
            background: #ecf0f3;
        }
        #background {
            background: #ebedef;
            border-left: 1px solid #e2e2eb;
            position: absolute;
            top: 0;
            left: 40%;
            right: 0;
            bottom: 0;
            z-index: 0;
            display: none;
        }
        @media (min-width: 768px) {
            #background {
                display: block;
            }
        }
        a {
            color: #666;
        }
        a:visited {
            color: #777;
        }
        a.parent {
            text-transform: uppercase;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
            text-decoration: none;
        }
        a.parent:after {
            content: ">";
            font-size: 14px;
            margin-left: 4px;
        }
    </style>
    
    <style>
        div.section:hover {
            background: #f8fafb;
        }
        div.section {
            position: relative;
        }
        div.section:after {
            clear: both;
            content: "";
            display: block;
        }
        div.section {
            border-top: 1px solid #e2e2eb;
        }
        div.footer {
            margin-top: 25px;
            position: relative;
            padding: 10px 0;
            text-align: center;
        }
        div.footer a {
            display: inline-block;
            margin: 8px;
            font-size: 1.3rem;
        }
        div.footer {
            background: #d5dbe0;
        }
    </style>
    <style>pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }

.highlight .c { color: #3D7B7B; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #9C6500 } /* Comment.Preproc */
.highlight .cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #E40000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #008400 } /* Generic.Inserted */
.highlight .go { color: #717171 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #687822 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #717171; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #767600 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #A45A77 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
        <style>
        div.section:hover div.code {
            background: #f8fafb;
        }
        div.section div.code {
            background: #ebedef;
              padding: 14px 8px 16px 15px;
              vertical-align: top;
        }
        @media (min-width: 768px) {
            div.section div.code {
                margin-left: 40%;
            }
        }
        </style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/mathtex-script-type.min.js" defer></script>
        <style>
            div.section div.doc {
                box-sizing: border-box;
                padding: 10px 8px 1px 8px;
                vertical-align: top;
                text-align: left;
                word-break: break-all;
            }
        @media (min-width: 768px) {
            div.section div.doc {
                float: left;
                width: 40%;
                min-height: 5px;
            }
        }
        @media (min-width: 1024px) {
            div.section div.doc {
                padding: 10px 25px 1px 50px;
            }
        }
        div.section div.doc img {
            max-width: 100%;
            transition:transform 0.25s ease;
        }
        img:hover {
            -webkit-transform:scale(1.75);
            transform:scale(1.75);
        }        
        </style>
        </head><body><div id="section_container"><div id="background"></div>
    <div class="section" id="0">
        
        <div class="doc">
            <p><a class="parent" href="../../index.html">Home</a><a class="parent" href="../index.html">Dataloader</a><a class="parent" href="index.html">Common</a></p>
        </div>
        
    </div>
    
    <div class="section" id="1">
        
        <div class="doc">
            <p><br><br><br><br></p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
    <span class="p">))</span>
    <span class="kn">from</span> <span class="nn">source.Utility.visualizer</span> <span class="kn">import</span> <span class="n">visualize_pytorch_tensor</span>
    <span class="kn">from</span> <span class="nn">source.Dataloader.Utility.converter</span> <span class="kn">import</span> <span class="n">labImg2EdgeTorch</span>
    <span class="kn">from</span> <span class="nn">source.Dataloader.Utility.dataloader</span> <span class="kn">import</span> <span class="n">create_dataloader</span>

<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">omegaconf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">source.Utility.image</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">source.Utility.augmentation</span> <span class="kn">import</span> <span class="n">AUG_TYPE</span>
<span class="kn">from</span> <span class="nn">source.Dataloader.datahandler</span> <span class="kn">import</span> <span class="n">DataHandler</span>
<span class="kn">from</span> <span class="nn">source.Logger.logger</span> <span class="kn">import</span> <span class="n">log_error</span><span class="p">,</span> <span class="n">log_warning</span>
<span class="kn">from</span> <span class="nn">source.Utility.visualizer</span> <span class="kn">import</span> <span class="n">visualize_pytorch_tensor</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="2">
        
        <div class="doc">
            <h1>Cityscape Dataset</h1>
<p>Dataset for the Cityscape dataset (https://www.cityscapes-dataset.com).
Currently it does support the semantic segmentation task along
with the stereo setup.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Cityscape_ds</span><span class="p">(</span><span class="n">DataHandler</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="3">
        
        <div class="doc">
            <pre><code>
</code></pre>
<p>Args:</p>
<ul>
<li><code>cfg (omegaconf.DictConfig)</code>:<ul>
<li>Hydra based configuration dictionary based on the given configuration .yaml file. <strong>Only the subset cfg object for the dataset is available at this point.</strong></li>
</ul>
</li>
</ul>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">DictConfig</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="4">
        
        <div class="doc">
            <p>It is possible to indicate labels to be ignored by overwriting <code>ignore_label</code>. The default value for this parameter is 255.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ignore_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">ignore_label</span>
        <span class="k">except</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">ConfigAttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="5">
        
        <div class="doc">
            <p>Publications show that standardization usually perform better with the Cityscape dataset. So it is possible to provide the mean and standard deviation per channel for the input images.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
                <span class="n">Standardize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">normalization_mean</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">normalization_std</span><span class="p">)</span>
            <span class="p">])</span>
        <span class="k">except</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">ConfigAttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transforms</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">log_warning</span><span class="p">(</span><span class="s2">&quot;Missing values for mean (normalization_mean) and std (normalization_std) for normalization process. Continue without transformation...&quot;</span><span class="p">)</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="6">
        
        <div class="doc">
            <p>Creates a sample from the dataset for a specific pair of data 
using an index. It will load the images using PIL, convert ground
truth data if necessary, apply data augmentation and convert 
sample entries into PyTorch Tensors. Additionally, it loads
the disparity map as 8-bit single channel images.</p>
<p>Returns:
    Dictionary sample in form of {'img_left' : img_left, 'img_right' : img_right, 'disparity' : disparity, 'label' : label, 'camera' : camera_conf }</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="7">
        
        <div class="doc">
            <p>Converts the incoming PIL images (left and right), the ground truth image and the disparity map into PyTorch tensors.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_toTensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="8">
        
        <div class="doc">
            <p>Loads the configuration file for the stereo camera setup.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_load_camera_conf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">camera_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="9">
        
        <div class="doc">
            <p>Loading disparity map and converting to correct values according to the given documentation from Cityscape.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_load_disparity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">disparity_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="10">
        
        <div class="doc">
            <p>Load an image using PIL.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_load_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">img_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="11">
        
        <div class="doc">
            <p>Loads the annotation file and returns list of annotations.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">_load_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="12">
        
        <div class="doc">
            <p>Searches in a predefined path for the cityscape dataset and collect
all information. It requires the standard cityscape folder structure.</p>
<p>The list <code>filenames</code> contains tuples with five possible elements:</p>
<pre><code>* img_left: Path to RGB image file of left camera
* img_right: Path to RGB image file of right camera
* disparity: Path to disparity map file
* label: Path to index gtFine_labelIds file
* camera: Path to camera configuration file
</code></pre>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">search_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="13">
        
        <div class="doc">
            <p>Returns the mapping from given label id to common training id.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">label_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="14">
        
        <div class="doc">
            <p>Returns the mapping from training id to RGB color.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">label2color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="15">
        
        <div class="doc">
            <p>Returns the mapping from RGB color to training id.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">color2label</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="16">
        
        <div class="doc">
            <p>Converts a label tensor of shape <code>[H, W]</code> to a RGB tensor of shape <code>[C, H, W]</code>.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">labelTensor2colorTensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lab_tensor</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="17">
        
        <div class="doc">
            <p>Method to apply data augmentation on a given sample.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">augmentation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="18">
        
        <div class="doc">
            <p>Transformation class to apply standardization, such that
<script type="math/tex; mode=display"> image = (image - mean) / std.</script>
</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Standardize</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="19">
        
        <div class="doc">
            <p>Args:</p>
<ul>
<li><code>mean (list)</code>:<ul>
<li>List of mean values for each channel of current dataset.</li>
</ul>
</li>
<li><code>std (list)</code>:<ul>
<li>List of std values for each channel of current dataset.</li>
</ul>
</li>
</ul>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">std</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="20">
        
        <div class="doc">
            <p>Applies the standardization to the input sample.</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="section" id="21">
        
        <div class="doc">
            <p>Local tests</p>
        </div>
        
        
        <div class="code">
            <div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">project_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">)</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">omegaconf</span><span class="o">.</span><span class="n">DictConfig</span><span class="p">({</span><span class="s1">&#39;dataset&#39;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="s1">&#39;Cityscape_ds&#39;</span><span class="p">,</span>
        <span class="s1">&#39;root&#39;</span> <span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">project_path</span><span class="p">,</span> <span class="s2">&quot;data/cityscape&quot;</span><span class="p">),</span>
        <span class="s1">&#39;set_name&#39;</span> <span class="p">:</span> <span class="s1">&#39;train&#39;</span><span class="p">,</span>
        <span class="s1">&#39;augmentation_methods&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;blur&#39;</span><span class="p">],</span>
        <span class="s1">&#39;batch_size&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;validation_ratio&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;normalization_mean&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.485</span><span class="p">,</span> <span class="mf">0.456</span><span class="p">,</span> <span class="mf">0.406</span><span class="p">],</span>
        <span class="s1">&#39;normalization_std&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.229</span><span class="p">,</span> <span class="mf">0.224</span><span class="p">,</span> <span class="mf">0.225</span><span class="p">]</span>
    <span class="p">}})</span>
    <span class="n">cityscape_ds</span> <span class="o">=</span> <span class="n">Cityscape_ds</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">cityscape_ds</span><span class="o">.</span><span class="n">split_train_valid</span><span class="p">()</span>
    <span class="n">dataloader_training</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">create_dataloader</span><span class="p">(</span><span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span> <span class="n">ds1</span><span class="o">=</span><span class="n">cityscape_ds</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataloader_training</span><span class="p">):</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">labImg2EdgeTorch</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])])</span>
        <span class="n">visualize_pytorch_tensor</span><span class="p">(</span>
            <span class="n">py_tensor</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">window_str</span><span class="o">=</span><span class="s2">&quot;edge&quot;</span><span class="p">,</span> 
            <span class="n">window_wait</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">visualize_pytorch_tensor</span><span class="p">(</span>
            <span class="n">py_tensor</span><span class="o">=</span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;img_left&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">window_str</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> 
            <span class="n">window_wait</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">visualize_pytorch_tensor</span><span class="p">(</span>
            <span class="n">py_tensor</span><span class="o">=</span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;img_right&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
            <span class="n">window_str</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> 
            <span class="n">window_wait</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">visualize_pytorch_tensor</span><span class="p">(</span>
            <span class="n">py_tensor</span><span class="o">=</span><span class="n">cityscape_ds</span><span class="o">.</span><span class="n">labelTensor2colorTensor</span><span class="p">(</span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
            <span class="n">window_str</span><span class="o">=</span><span class="s2">&quot;label&quot;</span><span class="p">,</span> 
            <span class="n">window_wait</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">visualize_pytorch_tensor</span><span class="p">(</span>
            <span class="n">py_tensor</span><span class="o">=</span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;disparity&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">uint8</span><span class="p">),</span> 
            <span class="n">window_str</span><span class="o">=</span><span class="s2">&quot;disparity&quot;</span><span class="p">,</span> 
            <span class="n">window_wait</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
</pre></div>

        </div>
        
    </div>
    
    <div class="footer">
        <a href="mailto:thomas.buechler@cariad.technology">Contact</a>
    </div>
    </div></body></html>
    